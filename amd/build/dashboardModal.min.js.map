{"version":3,"file":"dashboardModal.min.js","sources":["../src/dashboardModal.js"],"sourcesContent":["define(['jquery', 'core/modal_factory', 'core/modal_events', 'core/ajax', 'core/notification', 'core/str'],\r\n    function($, ModalFactory, ModalEvents, Ajax, Notification, String){\r\n\r\n        var tokenDeleteTrigger = $('.token_delete_button');\r\n        var functionDeleteTrigger = $('.function_delete_button');\r\n        var webserviceDeleteTrigger = $('.webservice_delete_button');\r\n        var webserviceEnableTrigger = $('.webservice_enable_button');\r\n        var webserviceUpdateFilesTrigger = $('.webservice_uploadfiles_button');\r\n        var webserviceDownloadFilesTrigger = $('.webservice_downloadfiles_button');\r\n        var wwwroot = M.cfg.wwwroot;\r\n\r\n        // Tokens modal.\r\n        ModalFactory.create({\r\n            type: ModalFactory.types.SAVE_CANCEL,\r\n            title: String.get_string('dashboard_delete_token_title', 'local_wswizard'),\r\n            body: String.get_string('dashboard_delete_token_body', 'local_wswizard'),\r\n            preShowCallback: function(triggerElement, modal) {\r\n                triggerElement = $(triggerElement);\r\n                // Get id from button class.\r\n                let tokenString = triggerElement[0].classList[0];\r\n                let tokenid = tokenString.substr(tokenString.lastIndexOf('tokenid') + 'tokenid'.length);\r\n                modal.params = {'tokenid': parseInt(tokenid)};\r\n                modal.setSaveButtonText(String.get_string('dashboard_modal_delete', 'local_wswizard'));\r\n            },\r\n            large: true,\r\n        }, tokenDeleteTrigger)\r\n            .done(function(modal) {\r\n                modal.getRoot().on(ModalEvents.save, function(e) {\r\n                    e.preventDefault();\r\n\r\n                    $.ajax({\r\n                        type: \"POST\",\r\n                        url: wwwroot + \"/local/wswizard/ajax.php?action=deleteToken&id=\" + modal.params['tokenid'],\r\n                        dataType: \"json\",\r\n                        success: function() {\r\n                            window.location.reload();\r\n                        },\r\n                    });\r\n                });\r\n            });\r\n\r\n        // Function modal.\r\n        ModalFactory.create({\r\n            type: ModalFactory.types.SAVE_CANCEL,\r\n            title: String.get_string('dashboard_delete_function_title', 'local_wswizard'),\r\n            body: String.get_string('dashboard_delete_function_body', 'local_wswizard'),\r\n            preShowCallback: function(triggerElement, modal) {\r\n                triggerElement = $(triggerElement);\r\n                // Get id from button class.\r\n                let functionIDString = triggerElement[0].classList[0];\r\n                let functionid = functionIDString\r\n                    .substr(functionIDString.lastIndexOf('functionid') + 'functionid'.length);\r\n\r\n                let functionNameString = triggerElement[0].classList[1];\r\n                let functionName = functionNameString.substr(\r\n                    functionIDString.lastIndexOf('functionname') + 'functionname'.length + 1);\r\n\r\n                modal.params = {'functionid': parseInt(functionid), 'functionname': functionName};\r\n                modal.setSaveButtonText(String.get_string('dashboard_modal_delete', 'local_wswizard'));\r\n            },\r\n            large: true,\r\n        }, functionDeleteTrigger)\r\n            .done(function(modal) {\r\n                modal.getRoot().on(ModalEvents.save, function(e) {\r\n                    e.preventDefault();\r\n                    $.ajax({\r\n                        type: \"POST\",\r\n                        url: wwwroot + \"/local/wswizard/ajax.php?action=deleteFunction&id=\" +\r\n                            modal.params['functionid'] + \"&functionname=\" + modal.params['functionname'],\r\n                        dataType: \"json\",\r\n                        success: function() {\r\n                            window.location.reload();\r\n                        },\r\n                    });\r\n                });\r\n            });\r\n\r\n        // Webservice modal.\r\n        ModalFactory.create({\r\n            type: ModalFactory.types.SAVE_CANCEL,\r\n            title: String.get_string('dashboard_delete_webservice_title', 'local_wswizard'),\r\n            body: String.get_string('dashboard_delete_webservice_body', 'local_wswizard'),\r\n            preShowCallback: function(triggerElement, modal) {\r\n                triggerElement = $(triggerElement);\r\n                // Get id from button class.\r\n                let webserviceIDString = triggerElement[0].classList[0];\r\n                let webserviceid = webserviceIDString.substr(\r\n                    webserviceIDString.lastIndexOf('webserviceid') + 'webserviceid'.length);\r\n\r\n                modal.params = {'webserviceid': parseInt(webserviceid)};\r\n                modal.setSaveButtonText(String.get_string('dashboard_modal_delete', 'local_wswizard'));\r\n            },\r\n            large: true,\r\n        }, webserviceDeleteTrigger)\r\n            .done(function(modal) {\r\n                modal.getRoot().on(ModalEvents.save, function(e) {\r\n                    e.preventDefault();\r\n                    $.ajax({\r\n                        type: \"POST\",\r\n                        url: wwwroot + \"/local/wswizard/ajax.php?action=deleteWebservice&id=\" + modal.params['webserviceid'],\r\n                        dataType: \"json\",\r\n                        success: function(resultData) {\r\n                            window.location.reload();\r\n                        },\r\n                    });\r\n                });\r\n            });\r\n\r\n        // Enable/disable webservice.\r\n        webserviceEnableTrigger.parent().on('click',function() {\r\n            let webserviceIDString = $(this).children()[0].classList[0];\r\n            let enablewebserviceid = webserviceIDString.substr(\r\n                webserviceIDString.lastIndexOf('enablewebserviceid') + 'enablewebserviceid'.length);\r\n            $.ajax({\r\n                type: \"POST\",\r\n                url: wwwroot + \"/local/wswizard/ajax.php?action=enableWebservice&id=\" + enablewebserviceid,\r\n                dataType: \"json\",\r\n                success: function() {\r\n                },\r\n            });\r\n        });\r\n\r\n        webserviceUpdateFilesTrigger.parent().on('click',function() {\r\n            let webserviceIDString = $(this).children()[0].classList[0];\r\n            let webserviceid = webserviceIDString.substr(\r\n                webserviceIDString.lastIndexOf('updateUploadFileswebserviceid') + 'updateUploadFileswebserviceid'.length);\r\n            $.ajax({\r\n                type: \"POST\",\r\n                url: wwwroot + \"/local/wswizard/ajax.php?action=updateUploadFiles&id=\" + webserviceid,\r\n                dataType: \"json\",\r\n                success: function() {\r\n                },\r\n            });\r\n        });\r\n\r\n        // Update Download Files for webservice.\r\n        webserviceDownloadFilesTrigger.parent().on('click',function() {\r\n            let webserviceIDString = $(this).children()[0].classList[0];\r\n            let webserviceid = webserviceIDString.substr(\r\n                webserviceIDString.lastIndexOf('downloadfileswebserviceid') + 'downloadfileswebserviceid'.length);\r\n            $.ajax({\r\n                type: \"POST\",\r\n                url: wwwroot + \"/local/wswizard/ajax.php?action=updateDownloadFiles&id=\" + webserviceid,\r\n                dataType: \"json\",\r\n                success: function() {\r\n                },\r\n            });\r\n        });\r\n\r\n    });"],"names":["define","$","ModalFactory","ModalEvents","Ajax","Notification","String","tokenDeleteTrigger","functionDeleteTrigger","webserviceDeleteTrigger","webserviceEnableTrigger","webserviceUpdateFilesTrigger","webserviceDownloadFilesTrigger","wwwroot","M","cfg","create","type","types","SAVE_CANCEL","title","get_string","body","preShowCallback","triggerElement","modal","tokenString","classList","tokenid","substr","lastIndexOf","length","params","parseInt","setSaveButtonText","large","done","getRoot","on","save","e","preventDefault","ajax","url","dataType","success","window","location","reload","functionIDString","functionid","functionName","webserviceIDString","webserviceid","resultData","parent","this","children","enablewebserviceid"],"mappings":"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"}