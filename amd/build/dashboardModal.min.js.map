{"version":3,"file":"dashboardModal.min.js","sources":["../src/dashboardModal.js"],"sourcesContent":["define(['jquery', 'core/modal_factory', 'core/modal_events', 'core/ajax', 'core/notification', 'core/str'],\n    function ($, ModalFactory, ModalEvents, Ajax, Notification, String) {\n\n        var tokenDeleteTrigger = $('.token_delete_button');\n        var functionDeleteTrigger = $('.function_delete_button');\n        var webserviceDeleteTrigger = $('.webservice_delete_button');\n        var webserviceEnableTrigger = $('.webservice_enable_button');\n        var webserviceUpdateFilesTrigger = $('.webservice_uploadfiles_button');\n        var webserviceDownloadFilesTrigger = $('.webservice_downloadfiles_button');\n        var wwwroot = M.cfg.wwwroot;\n\n        // Tokens modal.\n        ModalFactory.create({\n            type: ModalFactory.types.SAVE_CANCEL,\n            title: String.get_string('dashboard_delete_token_title', 'local_wswizard'),\n            body: String.get_string('dashboard_delete_token_body', 'local_wswizard'),\n            preShowCallback: function (triggerElement, modal) {\n                triggerElement = $(triggerElement);\n                // Get id from button class.\n                let tokenString = triggerElement[0].classList[0];\n                let tokenid = tokenString.substr(tokenString.lastIndexOf('tokenid') + 'tokenid'.length);\n                modal.params = {'tokenid': parseInt(tokenid)};\n                modal.setSaveButtonText(String.get_string('dashboard_modal_delete', 'local_wswizard'));\n            },\n            large: true,\n        }, tokenDeleteTrigger)\n            .done(function (modal) {\n                modal.getRoot().on(ModalEvents.save, function (e) {\n                    e.preventDefault();\n\n                    $.ajax({\n                        type: \"POST\",\n                        url: wwwroot + \"/local/wswizard/ajax.php?action=deleteToken&id=\" + modal.params['tokenid'],\n                        dataType: \"json\",\n                        success: function () {\n                            window.location.reload();\n                        },\n                    });\n                });\n            });\n\n        // Function modal.\n        ModalFactory.create({\n            type: ModalFactory.types.SAVE_CANCEL,\n            title: String.get_string('dashboard_delete_function_title', 'local_wswizard'),\n            body: String.get_string('dashboard_delete_function_body', 'local_wswizard'),\n            preShowCallback: function (triggerElement, modal) {\n                triggerElement = $(triggerElement);\n                // Get id from button class.\n                let functionIDString = triggerElement[0].classList[0];\n                let functionid = functionIDString\n                    .substr(functionIDString.lastIndexOf('functionid') + 'functionid'.length);\n\n                let functionNameString = triggerElement[0].classList[1];\n                let functionName = functionNameString.substr(\n                    functionIDString.lastIndexOf('functionname') + 'functionname'.length + 1);\n\n                modal.params = {'functionid': parseInt(functionid), 'functionname': functionName};\n                modal.setSaveButtonText(String.get_string('dashboard_modal_delete', 'local_wswizard'));\n            },\n            large: true,\n        }, functionDeleteTrigger)\n            .done(function (modal) {\n                modal.getRoot().on(ModalEvents.save, function (e) {\n                    e.preventDefault();\n                    $.ajax({\n                        type: \"POST\",\n                        url: wwwroot + \"/local/wswizard/ajax.php?action=deleteFunction&id=\" +\n                            modal.params['functionid'] + \"&functionname=\" + modal.params['functionname'],\n                        dataType: \"json\",\n                        success: function () {\n                            window.location.reload();\n                        },\n                    });\n                });\n            });\n\n        // Webservice modal.\n        ModalFactory.create({\n            type: ModalFactory.types.SAVE_CANCEL,\n            title: String.get_string('dashboard_delete_webservice_title', 'local_wswizard'),\n            body: String.get_string('dashboard_delete_webservice_body', 'local_wswizard'),\n            preShowCallback: function (triggerElement, modal) {\n                triggerElement = $(triggerElement);\n                // Get id from button class.\n                let webserviceIDString = triggerElement[0].classList[0];\n                let webserviceid = webserviceIDString.substr(\n                    webserviceIDString.lastIndexOf('webserviceid') + 'webserviceid'.length);\n\n                modal.params = {'webserviceid': parseInt(webserviceid)};\n                modal.setSaveButtonText(String.get_string('dashboard_modal_delete', 'local_wswizard'));\n            },\n            large: true,\n        }, webserviceDeleteTrigger)\n            .done(function (modal) {\n                modal.getRoot().on(ModalEvents.save, function (e) {\n                    e.preventDefault();\n                    $.ajax({\n                        type: \"POST\",\n                        url: wwwroot + \"/local/wswizard/ajax.php?action=deleteWebservice&id=\" + modal.params['webserviceid'],\n                        dataType: \"json\",\n                        success: function (resultData) {\n                            window.console.log(resultData);\n                            window.location.reload();\n                        },\n                    });\n                });\n            });\n\n        // Enable/disable webservice.\n        webserviceEnableTrigger.parent().on('click',function () {\n            let webserviceIDString = $(this).children()[0].classList[0];\n            let enablewebserviceid = webserviceIDString.substr(\n                webserviceIDString.lastIndexOf('enablewebserviceid') + 'enablewebserviceid'.length);\n            $.ajax({\n                type: \"POST\",\n                url: wwwroot + \"/local/wswizard/ajax.php?action=enableWebservice&id=\" + enablewebserviceid,\n                dataType: \"json\",\n                success: function () {\n                },\n            });\n        });\n\n        webserviceUpdateFilesTrigger.parent().on('click',function () {\n            let webserviceIDString = $(this).children()[0].classList[0];\n            let webserviceid = webserviceIDString.substr(\n                webserviceIDString.lastIndexOf('updateUploadFileswebserviceid') + 'updateUploadFileswebserviceid'.length);\n            $.ajax({\n                type: \"POST\",\n                url: wwwroot + \"/local/wswizard/ajax.php?action=updateUploadFiles&id=\" + webserviceid,\n                dataType: \"json\",\n                success: function () {\n                },\n            });\n        });\n\n        // Update Download Files for webservice.\n        webserviceDownloadFilesTrigger.parent().on('click',function () {\n            let webserviceIDString = $(this).children()[0].classList[0];\n            let webserviceid = webserviceIDString.substr(\n                webserviceIDString.lastIndexOf('downloadfileswebserviceid') + 'downloadfileswebserviceid'.length);\n            $.ajax({\n                type: \"POST\",\n                url: wwwroot + \"/local/wswizard/ajax.php?action=updateDownloadFiles&id=\" + webserviceid,\n                dataType: \"json\",\n                success: function () {\n                },\n            });\n        });\n\n    });"],"names":["define","$","ModalFactory","ModalEvents","Ajax","Notification","String","tokenDeleteTrigger","functionDeleteTrigger","webserviceDeleteTrigger","webserviceEnableTrigger","webserviceUpdateFilesTrigger","webserviceDownloadFilesTrigger","wwwroot","M","cfg","create","type","types","SAVE_CANCEL","title","get_string","body","preShowCallback","triggerElement","modal","tokenString","classList","tokenid","substr","lastIndexOf","length","params","parseInt","setSaveButtonText","large","done","getRoot","on","save","e","preventDefault","ajax","url","dataType","success","window","location","reload","functionIDString","functionid","functionName","webserviceIDString","webserviceid","resultData","console","log","parent","this","children","enablewebserviceid"],"mappings":"AAAAA,uCAAO,CAAC,SAAU,qBAAsB,oBAAqB,YAAa,oBAAqB,aAC3F,SAAUC,EAAGC,aAAcC,YAAaC,KAAMC,aAAcC,YAEpDC,mBAAqBN,EAAE,wBACvBO,sBAAwBP,EAAE,2BAC1BQ,wBAA0BR,EAAE,6BAC5BS,wBAA0BT,EAAE,6BAC5BU,6BAA+BV,EAAE,kCACjCW,+BAAiCX,EAAE,oCACnCY,QAAUC,EAAEC,IAAIF,QAGpBX,aAAac,OAAO,CAChBC,KAAMf,aAAagB,MAAMC,YACzBC,MAAOd,OAAOe,WAAW,+BAAgC,kBACzDC,KAAMhB,OAAOe,WAAW,8BAA+B,kBACvDE,gBAAiB,SAAUC,eAAgBC,WAGnCC,aAFJF,eAAiBvB,EAAEuB,iBAEc,GAAGG,UAAU,GAC1CC,QAAUF,YAAYG,OAAOH,YAAYI,YAAY,WAAa,UAAUC,QAChFN,MAAMO,OAAS,SAAYC,SAASL,UACpCH,MAAMS,kBAAkB5B,OAAOe,WAAW,yBAA0B,oBAExEc,OAAO,GACR5B,oBACE6B,MAAK,SAAUX,OACZA,MAAMY,UAAUC,GAAGnC,YAAYoC,MAAM,SAAUC,GAC3CA,EAAEC,iBAEFxC,EAAEyC,KAAK,CACHzB,KAAM,OACN0B,IAAK9B,QAAU,kDAAoDY,MAAMO,OAAN,QACnEY,SAAU,OACVC,QAAS,WACLC,OAAOC,SAASC,kBAOpC9C,aAAac,OAAO,CAChBC,KAAMf,aAAagB,MAAMC,YACzBC,MAAOd,OAAOe,WAAW,kCAAmC,kBAC5DC,KAAMhB,OAAOe,WAAW,iCAAkC,kBAC1DE,gBAAiB,SAAUC,eAAgBC,WAGnCwB,kBAFJzB,eAAiBvB,EAAEuB,iBAEmB,GAAGG,UAAU,GAC/CuB,WAAaD,iBACZpB,OAAOoB,iBAAiBnB,YAAY,cAAgB,aAAaC,QAGlEoB,aADqB3B,eAAe,GAAGG,UAAU,GACfE,OAClCoB,iBAAiBnB,YAAY,gBAAkB,eAAeC,OAAS,GAE3EN,MAAMO,OAAS,YAAeC,SAASiB,yBAA6BC,cACpE1B,MAAMS,kBAAkB5B,OAAOe,WAAW,yBAA0B,oBAExEc,OAAO,GACR3B,uBACE4B,MAAK,SAAUX,OACZA,MAAMY,UAAUC,GAAGnC,YAAYoC,MAAM,SAAUC,GAC3CA,EAAEC,iBACFxC,EAAEyC,KAAK,CACHzB,KAAM,OACN0B,IAAK9B,QAAU,qDACXY,MAAMO,OAAN,WAA6B,iBAAmBP,MAAMO,OAAN,aACpDY,SAAU,OACVC,QAAS,WACLC,OAAOC,SAASC,kBAOpC9C,aAAac,OAAO,CAChBC,KAAMf,aAAagB,MAAMC,YACzBC,MAAOd,OAAOe,WAAW,oCAAqC,kBAC9DC,KAAMhB,OAAOe,WAAW,mCAAoC,kBAC5DE,gBAAiB,SAAUC,eAAgBC,WAGnC2B,oBAFJ5B,eAAiBvB,EAAEuB,iBAEqB,GAAGG,UAAU,GACjD0B,aAAeD,mBAAmBvB,OAClCuB,mBAAmBtB,YAAY,gBAAkB,eAAeC,QAEpEN,MAAMO,OAAS,cAAiBC,SAASoB,eACzC5B,MAAMS,kBAAkB5B,OAAOe,WAAW,yBAA0B,oBAExEc,OAAO,GACR1B,yBACE2B,MAAK,SAAUX,OACZA,MAAMY,UAAUC,GAAGnC,YAAYoC,MAAM,SAAUC,GAC3CA,EAAEC,iBACFxC,EAAEyC,KAAK,CACHzB,KAAM,OACN0B,IAAK9B,QAAU,uDAAyDY,MAAMO,OAAN,aACxEY,SAAU,OACVC,QAAS,SAAUS,YACfR,OAAOS,QAAQC,IAAIF,YACnBR,OAAOC,SAASC,kBAOpCtC,wBAAwB+C,SAASnB,GAAG,SAAQ,eACpCc,mBAAqBnD,EAAEyD,MAAMC,WAAW,GAAGhC,UAAU,GACrDiC,mBAAqBR,mBAAmBvB,OACxCuB,mBAAmBtB,YAAY,sBAAwB,qBAAqBC,QAChF9B,EAAEyC,KAAK,CACHzB,KAAM,OACN0B,IAAK9B,QAAU,uDAAyD+C,mBACxEhB,SAAU,OACVC,QAAS,kBAKjBlC,6BAA6B8C,SAASnB,GAAG,SAAQ,eACzCc,mBAAqBnD,EAAEyD,MAAMC,WAAW,GAAGhC,UAAU,GACrD0B,aAAeD,mBAAmBvB,OAClCuB,mBAAmBtB,YAAY,iCAAmC,gCAAgCC,QACtG9B,EAAEyC,KAAK,CACHzB,KAAM,OACN0B,IAAK9B,QAAU,wDAA0DwC,aACzET,SAAU,OACVC,QAAS,kBAMjBjC,+BAA+B6C,SAASnB,GAAG,SAAQ,eAC3Cc,mBAAqBnD,EAAEyD,MAAMC,WAAW,GAAGhC,UAAU,GACrD0B,aAAeD,mBAAmBvB,OAClCuB,mBAAmBtB,YAAY,6BAA+B,4BAA4BC,QAC9F9B,EAAEyC,KAAK,CACHzB,KAAM,OACN0B,IAAK9B,QAAU,0DAA4DwC,aAC3ET,SAAU,OACVC,QAAS"}